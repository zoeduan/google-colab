{
  "title": "ULER : A Model-Agnostic Method to Control Generated Length for Large Language Models",
  "authors": [
    "Jiaming Li",
    "Lei Zhang",
    "Yunshui Li",
    "Ziqiang Liu",
    "Yuelin Bai",
    "Run Luo",
    "Longze Chen",
    "Min Yang",
    "Gemma Team",
    "Thomas Mesnard",
    "Cassidy Hardin",
    "Robert Dadashi",
    "Surya Bhupatiraju",
    "Shreya Pathak",
    "Laurent Sifre",
    "Mihir Morgane Rivière",
    "Sanjay Kale",
    "Juliette Love",
    "Pouya Tafti",
    "Pier Léonard Hussenot",
    "Giuseppe Sessa",
    "Aakanksha Chowdhery",
    "Adam Roberts",
    "Aditya Barua",
    "Alex Botev",
    "Alex Castro- Ros",
    "Ambrose Slone",
    "Amélie Héliou",
    "Andrea Tac- Chetti",
    "Anna Bulanova",
    "Antonia Paterson",
    "Beth Tsai",
    "Bobak Shahriari",
    "Charline Le Lan",
    "Christo- Pher A Choquette-Choo",
    "Clément Crepy",
    "Daniel Cer",
    "Daphne Ippolito",
    "David Reid",
    "Elena Buchatskaya",
    "Eric Ni",
    "Eric Noland",
    "Geng Yan",
    "George Tucker",
    "George-Christian Muraru",
    "Grigory Rozhdestvenskiy",
    "Henryk Michalewski",
    "Ian Tenney",
    "Ivan Grishchenko",
    "Jacob Austin",
    "James Keeling",
    "Jane Labanowski",
    "Jean-Baptiste Lespiau",
    "Jeff Stanway",
    "Jenny Bren- Nan",
    "Jeremy Chen",
    "Johan Ferret",
    "Justin Chiu",
    "Justin Mao-Jones",
    "Katherine Lee",
    "Kathy Yu",
    "Katie Milli- Can",
    "Lars Lowe Sjoesund",
    "Lisa Lee",
    "Lucas Dixon",
    "Machel Reid",
    "Maciej Mikuła",
    "Mateo Wirth",
    "Michael Sharman",
    "Nikolai Chinaev",
    "Nithum Thain",
    "Olivier Bachem",
    "Oscar Chang",
    "Oscar Wahltinez",
    "Paige Bai- Ley",
    "Paul Michel",
    "Petko Yotov",
    "Rahma Chaabouni",
    "Ramona Comanescu",
    "Reena Jana",
    "Rohan Anil",
    "Ross Mcilroy",
    "Ruibo Liu",
    "Ryan Mullins",
    "Samuel L Smith",
    "Sebastian Borgeaud",
    "Sertan Girgin",
    "Sholto Douglas",
    "Shree Pandya",
    "Siamak Shakeri",
    "Soham De",
    "Ted Kli- Menko",
    "Tom Hennigan",
    "Vlad Feinberg",
    "Wojciech Stokowiec",
    "Yu Hui Chen",
    "Zafarali Ahmed",
    "Zhitao Gong",
    "Tris Warkentin",
    "Ludovic Peran",
    "Minh Giang",
    "Clément Farabet",
    "Oriol Vinyals",
    "Jeff Dean",
    "Koray Kavukcuoglu",
    "Demis Hassabis",
    "Zoubin Ghahramani",
    "Douglas Eck",
    "Joelle Barral",
    "Fernando Pereira",
    "Eli Collins",
    "Armand Joulin",
    "Noah Fiedel",
    "Evan Senter",
    "Alek Andreev",
    "Kathleen 2024 Kenealy",
    "Gemma"
  ],
  "abstract": "\n The instruction-following ability of large language models enables humans to interact with AI agents in a natural way. However, when required to generate responses of a specific length, large language models often struggle to meet users' needs due to their inherent difficulty in accurately perceiving numerical constraints. To explore the ability of large language models to control the length of generated responses, we propose the Target Length Generation Task (TLG) and design two metrics, Precise Match (PM) and Flexible Match (FM) to evaluate the model's performance in adhering to specified response lengths. Furthermore, we introduce a novel, model-agnostic approach called RULER, which employs Meta Length Tokens (MLTs) to enhance the instruction-following ability of large language models under length-constrained instructions. Specifically, RULER equips LLMs with the ability to generate responses of a specified length based on length constraints within the instructions. Moreover, RULER can automatically generate appropriate MLT when length constraints are not explicitly provided, demonstrating excellent versatility and generalization. Comprehensive experiments show the effectiveness of RULER across different LLMs on Target Length Generation Task, e.g., at All Level 27.97 average gain on PM, 29.57 average gain on FM. In addition, we conduct extensive ablation experiments to further substantiate the efficacy and generalization of RULER. Our code and data is available at  https://github.com/Geaming2002/Ruler . \n",
  "references": [
    {
      "id": null,
      "title": "ULER : A Model-Agnostic Method to Control Generated Length for Large Language Models",
      "authors": [
        "Jiaming Li",
        "Lei Zhang",
        "Yunshui Li",
        "Ziqiang Liu",
        "Yuelin Bai",
        "Run Luo",
        "Longze Chen",
        "Min Yang",
        "Gemma Team",
        "Thomas Mesnard",
        "Cassidy Hardin",
        "Robert Dadashi",
        "Surya Bhupatiraju",
        "Shreya Pathak",
        "Laurent Sifre",
        "Morgane Rivière",
        "Sanjay Kale",
        "Juliette Love",
        "Pouya Tafti",
        "Léonard Hussenot",
        "Giuseppe Sessa",
        "Aakanksha Chowdhery",
        "Adam Roberts",
        "Aditya Barua",
        "Alex Botev",
        "Alex Castro- Ros",
        "Ambrose Slone",
        "Amélie Héliou",
        "Andrea Tac- Chetti",
        "Anna Bulanova",
        "Antonia Paterson",
        "Beth Tsai",
        "Bobak Shahriari",
        "Charline Le Lan",
        "Christo- Pher A Choquette-Choo",
        "Clément Crepy",
        "Daniel Cer",
        "Daphne Ippolito",
        "David Reid",
        "Elena Buchatskaya",
        "Eric Ni",
        "Eric Noland",
        "Geng Yan",
        "George Tucker",
        "George-Christian Muraru",
        "Grigory Rozhdestvenskiy",
        "Henryk Michalewski",
        "Ian Tenney",
        "Ivan Grishchenko",
        "Jacob Austin",
        "James Keeling",
        "Jane Labanowski",
        "Jean-Baptiste Lespiau",
        "Jeff Stanway",
        "Jenny Bren- Nan",
        "Jeremy Chen",
        "Johan Ferret",
        "Justin Chiu",
        "Justin Mao-Jones",
        "Katherine Lee",
        "Kathy Yu",
        "Katie Milli- Can",
        "Lars Lowe Sjoesund",
        "Lisa Lee",
        "Lucas Dixon",
        "Machel Reid",
        "Maciej Mikuła",
        "Mateo Wirth",
        "Michael Sharman",
        "Nikolai Chinaev",
        "Nithum Thain",
        "Olivier Bachem",
        "Oscar Chang",
        "Oscar Wahltinez",
        "Paige Bai- Ley",
        "Paul Michel",
        "Petko Yotov",
        "Rahma Chaabouni",
        "Ramona Comanescu",
        "Reena Jana",
        "Rohan Anil",
        "Ross Mcilroy",
        "Ruibo Liu",
        "Ryan Mullins",
        "Samuel L Smith",
        "Sebastian Borgeaud",
        "Sertan Girgin",
        "Sholto Douglas",
        "Shree Pandya",
        "Siamak Shakeri",
        "Soham De",
        "Ted Kli- Menko",
        "Tom Hennigan",
        "Vlad Feinberg",
        "Wojciech Stokowiec",
        "Yu Hui Chen",
        "Zafarali Ahmed",
        "Zhitao Gong",
        "Tris Warkentin",
        "Ludovic Peran",
        "Minh Giang",
        "Clément Farabet",
        "Oriol Vinyals",
        "Jeff Dean",
        "Koray Kavukcuoglu",
        "Demis Hassabis",
        "Zoubin Ghahramani",
        "Douglas Eck",
        "Joelle Barral",
        "Fernando Pereira",
        "Eli Collins",
        "Armand Joulin",
        "Noah Fiedel",
        "Evan Senter",
        "Alek Andreev",
        "Kathleen 2024 Kenealy",
        "Gemma"
      ],
      "year": "2024",
      "venue": "",
      "doi": ""
    },
    {
      "id": "b0",
      "title": "Shyamal Anadkat, et al. 2023. Gpt-4 technical report",
      "authors": [
        "Josh References",
        "Steven Achiam",
        "Sandhini Adler",
        "Lama Agarwal",
        "Ilge Ahmad",
        "Florencia Akkaya",
        "Diogo Leoni Aleman",
        "Janko Almeida",
        "Sam Altenschmidt",
        "Altman"
      ],
      "year": "",
      "venue": "Shyamal Anadkat, et al. 2023. Gpt-4 technical report",
      "doi": ""
    },
    {
      "id": "b1",
      "title": "",
      "authors": [
        ": Ai",
        "Alex Young",
        "Bei Chen",
        "Chao Li",
        "Chengen Huang",
        "Ge Zhang",
        "Guanwei Zhang",
        "Heng Li",
        "Jiangcheng Zhu",
        "Jianqun Chen",
        "Jing Chang",
        "Kaidong Yu",
        "Peng Liu",
        "Qiang Liu",
        "Shawn Yue",
        "Senbin Yang",
        "Shiming Yang",
        "Tao Yu",
        "Wen Xie",
        "Wenhao Huang",
        "Xiaohui Hu",
        "Xiaoyi Ren",
        "Xinyao Niu",
        "Pengcheng Nie",
        "Yuchi Xu",
        "Yudong Liu",
        "Yue Wang",
        "Yuxuan Cai",
        "Zhenyu Gu",
        "Zhiyuan Liu"
      ],
      "year": "",
      "venue": "",
      "doi": ""
    },
    {
      "id": "b2",
      "title": "Llama 3 model card",
      "authors": [
        "Ai@meta"
      ],
      "year": "2024",
      "venue": "Llama 3 model card",
      "doi": ""
    },
    {
      "id": "b3",
      "title": "Qwen technical report",
      "authors": [
        "Jinze Bai",
        "Shuai Bai",
        "Yunfei Chu",
        "Zeyu Cui",
        "Kai Dang",
        "Xiaodong Deng",
        "Yang Fan",
        "Wenbin Ge",
        "Yu Han",
        "Fei Huang",
        "Binyuan Hui",
        "Luo Ji",
        "Mei Li",
        "Junyang Lin",
        "Runji Lin",
        "Dayiheng Liu",
        "Gao Liu",
        "Chengqiang Lu",
        "Keming Lu",
        "Jianxin Ma",
        "Rui Men",
        "Xingzhang Ren",
        "Xuancheng Ren",
        "Chuanqi Tan",
        "Sinan Tan",
        "Jianhong Tu",
        "Peng Wang",
        "Shijie Wang",
        "Wei Wang",
        "Shengguang Wu",
        "Benfeng Xu",
        "Jin Xu",
        "An Yang",
        "Hao Yang",
        "Jian Yang",
        "Shusheng Yang",
        "Yang Yao",
        "Bowen Yu",
        "Hongyi Yuan",
        "Zheng Yuan",
        "Jianwei Zhang",
        "Xingxuan Zhang",
        "Yichang Zhang",
        "Zhenru Zhang",
        "Chang Zhou",
        "Jingren Zhou"
      ],
      "year": "2023",
      "venue": "Qwen technical report",
      "doi": ""
    },
    {
      "id": "b4",
      "title": "Language models are few-shot learners",
      "authors": [
        "Tom Brown",
        "Benjamin Mann",
        "Nick Ryder",
        "Melanie Subbiah",
        "Jared D Kaplan",
        "Prafulla Dhariwal",
        "Arvind Neelakantan",
        "Pranav Shyam",
        "Girish Sastry",
        "Amanda Askell"
      ],
      "year": "2020",
      "venue": "Advances in neural information processing systems",
      "doi": ""
    },
    {
      "id": "b5",
      "title": "Instruction mining: Instruction data selection for tuning large language models",
      "authors": [
        "Yihan Cao",
        "Yanbin Kang",
        "Chi Wang",
        "Lichao Sun"
      ],
      "year": "2024",
      "venue": "Instruction mining: Instruction data selection for tuning large language models",
      "doi": ""
    },
    {
      "id": "b6",
      "title": "Meta-learning via language model in-context tuning",
      "authors": [
        "Yanda Chen",
        "Ruiqi Zhong",
        "Sheng Zha",
        "George Karypis",
        "He He"
      ],
      "year": "2022",
      "venue": "Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics",
      "doi": "10.18653/v1/2022.acl-long.53"
    },
    {
      "id": "b7",
      "title": "Think you have solved question answering? try arc, the ai2 reasoning challenge",
      "authors": [
        "Peter Clark",
        "Isaac Cowhey",
        "Oren Etzioni",
        "Tushar Khot",
        "Ashish Sabharwal",
        "Carissa Schoenick",
        "Oyvind Tafjord"
      ],
      "year": "2018",
      "venue": "Think you have solved question answering? try arc, the ai2 reasoning challenge",
      "doi": ""
    },
    {
      "id": "b8",
      "title": "Training verifiers to solve math word problems",
      "authors": [
        "Karl Cobbe",
        "Vineet Kosaraju",
        "Mohammad Bavarian",
        "Mark Chen",
        "Heewoo Jun",
        "Lukasz Kaiser",
        "Matthias Plappert",
        "Jerry Tworek",
        "Jacob Hilton",
        "Reiichiro Nakano",
        "Christopher Hesse",
        "John Schulman"
      ],
      "year": "2021",
      "venue": "Training verifiers to solve math word problems",
      "doi": ""
    },
    {
      "id": "b9",
      "title": "Deepseek llm: Scaling opensource language models with longtermism",
      "authors": [
        "Deepseek-Ai"
      ],
      "year": "2024",
      "venue": "Deepseek llm: Scaling opensource language models with longtermism",
      "doi": ""
    },
    {
      "id": "b10",
      "title": "BERT: Pre-training of deep bidirectional transformers for language understanding",
      "authors": [
        "Jacob Devlin",
        "Ming-Wei Chang",
        "Kenton Lee",
        "Kristina Toutanova"
      ],
      "year": "2019",
      "venue": "Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies",
      "doi": "10.18653/v1/N19-1423"
    },
    {
      "id": "b11",
      "title": "A survey on in-context learning",
      "authors": [
        "Qingxiu Dong",
        "Lei Li",
        "Damai Dai",
        "Ce Zheng",
        "Zhiyong Wu",
        "Baobao Chang",
        "Xu Sun",
        "Jingjing Xu",
        "Zhifang Sui"
      ],
      "year": "2022",
      "venue": "A survey on in-context learning",
      "doi": ""
    },
    {
      "id": "b12",
      "title": "Eli5: Long form question answering",
      "authors": [
        "Angela Fan",
        "Yacine Jernite",
        "Ethan Perez",
        "David Grangier",
        "Jason Weston",
        "Michael Auli"
      ],
      "year": "2019",
      "venue": "Proceedings of ACL",
      "doi": ""
    },
    {
      "id": "b13",
      "title": "A new algorithm for data compression",
      "authors": [
        "Philip Gage"
      ],
      "year": "1994",
      "venue": "The C Users Journal archive",
      "doi": ""
    },
    {
      "id": "b14",
      "title": "",
      "authors": [
        "Leo Gao",
        "Jonathan Tow",
        "Stella Baber Abbasi",
        "Sid Biderman",
        "Anthony Black",
        "Charles Dipofi",
        "Laurence Foster",
        "Jeffrey Golding",
        "Alain Hsu",
        "Haonan Le Noac'h",
        "Kyle Li",
        "Niklas Mcdonell",
        "Chris Muennighoff",
        "Jason Ociepa",
        "Laria Phang",
        "Hailey Reynolds",
        "Aviya Schoelkopf",
        "Lintang Skowron",
        "Eric Sutawika",
        "Tang"
      ],
      "year": "",
      "venue": "Anish Thite",
      "doi": "10.5281/zenodo.12608602"
    },
    {
      "id": "b15",
      "title": "RealToxi-cityPrompts: Evaluating neural toxic degeneration in language models",
      "authors": [
        "Suchin Samuel Gehman",
        "Maarten Gururangan",
        "Yejin Sap",
        "Noah A Choi",
        "Smith"
      ],
      "year": "2020",
      "venue": "Findings of the Association for Computational Linguistics: EMNLP 2020",
      "doi": "10.18653/v1/2020.findings-emnlp.301"
    },
    {
      "id": "b16",
      "title": "Measuring massive multitask language understanding",
      "authors": [
        "Dan Hendrycks",
        "Collin Burns",
        "Steven Basart",
        "Andy Zou",
        "Mantas Mazeika",
        "Dawn Song",
        "Jacob Steinhardt"
      ],
      "year": "2021",
      "venue": "Proceedings of the International Conference on Learning Representations (ICLR)",
      "doi": ""
    },
    {
      "id": "b17",
      "title": "Towards reasoning in large language models: A survey",
      "authors": [
        "Jie Huang",
        "Kevin Chen",
        "-Chuan Chang"
      ],
      "year": "2023",
      "venue": "Findings of the Association for Computational Linguistics: ACL 2023",
      "doi": "10.18653/v1/2023.findings-acl.67"
    },
    {
      "id": "b18",
      "title": "",
      "authors": [
        "Albert Q Jiang",
        "Alexandre Sablayrolles",
        "Arthur Mensch",
        "Chris Bamford",
        "Devendra Singh Chaplot",
        "Diego De Las Casas",
        "Florian Bressand",
        "Gianna Lengyel",
        "Guillaume Lample",
        "Lucile Saulnier",
        "Renard Lélio",
        "Marie-Anne Lavaud",
        "Pierre Lachaux",
        "Teven Stock",
        "Thibaut Le Scao",
        "Thomas Lavril",
        "Timothée Wang",
        "Lacroix"
      ],
      "year": "",
      "venue": "",
      "doi": ""
    },
    {
      "id": "b19",
      "title": "Hierarchical and dynamic prompt compression for efficient zero-shot API usage",
      "authors": [
        "Yichen Jiang",
        "Marco Vecchio",
        "Mohit Bansal",
        "Anders Johannsen"
      ],
      "year": "2024",
      "venue": "Findings of the Association for Computational Linguistics: EACL 2024",
      "doi": ""
    },
    {
      "id": "b20",
      "title": "",
      "authors": [
        "Zachary Kenton",
        "Tom Everitt",
        "Laura Weidinger",
        "Iason Gabriel",
        "Vladimir Mikulik",
        "Geoffrey Irving"
      ],
      "year": "2021",
      "venue": "",
      "doi": ""
    },
    {
      "id": "b21",
      "title": "Efficient memory management for large language model serving with pagedattention",
      "authors": [
        "Woosuk Kwon",
        "Zhuohan Li",
        "Siyuan Zhuang",
        "Ying Sheng",
        "Lianmin Zheng",
        "Cody Hao Yu",
        "Joseph E Gonzalez",
        "Hao Zhang",
        "Ion Stoica"
      ],
      "year": "2023",
      "venue": "Proceedings of the ACM SIGOPS 29th Symposium on Operating Systems Principles",
      "doi": ""
    },
    {
      "id": "b22",
      "title": "Longform: Effective instruction tuning with reverse instructions",
      "authors": [
        "Abdullatif Köksal",
        "Timo Schick",
        "Anna Korhonen",
        "Hinrich Schütze"
      ],
      "year": "2023",
      "venue": "Longform: Effective instruction tuning with reverse instructions",
      "doi": ""
    },
    {
      "id": "b23",
      "title": "Yedid Hoshen, and Amnon Shashua. 2022. The inductive bias of in-context learning: Rethinking pretraining example design",
      "authors": [
        "Yoav Levine",
        "Noam Wies",
        "Daniel Jannai",
        "Dan Navon"
      ],
      "year": "",
      "venue": "International Conference on Learning Representations",
      "doi": ""
    },
    {
      "id": "b24",
      "title": "and Ion Stoica. 2024a. From live data to high-quality benchmarks: The arena-hard pipeline",
      "authors": [
        "Tianle Li",
        "Wei-Lin Chiang",
        "Evan Frick",
        "Lisa Dunlap",
        "Banghua Zhu",
        "Joseph E Gonzalez"
      ],
      "year": "",
      "venue": "and Ion Stoica. 2024a. From live data to high-quality benchmarks: The arena-hard pipeline",
      "doi": ""
    },
    {
      "id": "b25",
      "title": "Compressing context to enhance inference efficiency of large language models",
      "authors": [
        "Yucheng Li",
        "Bo Dong",
        "Frank Guerin",
        "Chenghua Lin"
      ],
      "year": "2023",
      "venue": "Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing",
      "doi": "10.18653/v1/2023.emnlp-main.391"
    },
    {
      "id": "b26",
      "title": "2024b. One-shot learning as instruction data prospector for large language models",
      "authors": [
        "Yunshui Li",
        "Binyuan Hui",
        "Xiaobo Xia",
        "Jiaxi Yang",
        "Min Yang",
        "Lei Zhang",
        "Shuzheng Si",
        "Ling-Hao Chen",
        "Junhao Liu",
        "Tongliang Liu",
        "Fei Huang",
        "Yongbin Li"
      ],
      "year": "",
      "venue": "2024b. One-shot learning as instruction data prospector for large language models",
      "doi": ""
    },
    {
      "id": "b27",
      "title": "TruthfulQA: Measuring how models mimic human falsehoods",
      "authors": [
        "Stephanie Lin",
        "Jacob Hilton",
        "Owain Evans"
      ],
      "year": "2022",
      "venue": "Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics",
      "doi": "10.18653/v1/2022.acl-long.229"
    },
    {
      "id": "b28",
      "title": "TCRA-LLM: Token compression retrieval augmented large language model for inference cost reduction",
      "authors": [
        "Junyi Liu",
        "Liangzhi Li",
        "Tong Xiang",
        "Bowen Wang",
        "Yiming Qian"
      ],
      "year": "2023",
      "venue": "Findings of the Association for Computational Linguistics: EMNLP 2023",
      "doi": "10.18653/v1/2023.findings-emnlp.655"
    },
    {
      "id": "b29",
      "title": "What makes good data for alignment? a comprehensive study of automatic data selection in instruction tuning",
      "authors": [
        "Wei Liu",
        "Weihao Zeng",
        "Keqing He",
        "Yong Jiang",
        "Junxian He"
      ],
      "year": "2024",
      "venue": "The Twelfth International Conference on Learning Representations",
      "doi": ""
    },
    {
      "id": "b30",
      "title": "Learning to compress prompts with gist tokens",
      "authors": [
        "Jesse Mu",
        "Xiang",
        "Lisa Li",
        "Noah Goodman"
      ],
      "year": "2023",
      "venue": "Thirty-seventh Conference on Neural Information Processing Systems",
      "doi": ""
    },
    {
      "id": "b31",
      "title": "Training language models to follow instructions with human feedback. Advances in neural information processing systems",
      "authors": [
        "Long Ouyang",
        "Jeffrey Wu",
        "Xu Jiang",
        "Diogo Almeida",
        "Carroll Wainwright",
        "Pamela Mishkin",
        "Chong Zhang",
        "Sandhini Agarwal",
        "Katarina Slama",
        "Alex Ray"
      ],
      "year": "2022",
      "venue": "Training language models to follow instructions with human feedback. Advances in neural information processing systems",
      "doi": ""
    },
    {
      "id": "b32",
      "title": "Openhermes 2.5: An open dataset of synthetic data for generalist llm assistants",
      "authors": [
        "Teknium"
      ],
      "year": "2023",
      "venue": "Openhermes 2.5: An open dataset of synthetic data for generalist llm assistants",
      "doi": ""
    },
    {
      "id": "b33",
      "title": "Function vectors in large language models",
      "authors": [
        "Eric Todd",
        "Millicent Li",
        "Arnab",
        "Sen Sharma",
        "Aaron Mueller",
        "Byron C Wallace",
        "David Bau"
      ],
      "year": "2024",
      "venue": "The Twelfth International Conference on Learning Representations",
      "doi": ""
    },
    {
      "id": "b34",
      "title": "Attention is all you need",
      "authors": [
        "Ashish Vaswani",
        "Noam Shazeer",
        "Niki Parmar",
        "Jakob Uszkoreit",
        "Llion Jones",
        "Aidan N Gomez",
        "Łukasz Kaiser",
        "Illia Polosukhin"
      ],
      "year": "2017",
      "venue": "Advances in neural information processing systems",
      "doi": ""
    },
    {
      "id": "b35",
      "title": "2022a. Finetuned language models are zero-shot learners",
      "authors": [
        "Alexander Wei",
        "Nika Haghtalab",
        "Jacob Steinhardt"
      ],
      "year": "2024",
      "venue": "Advances in Neural Information Processing Systems",
      "doi": ""
    },
    {
      "id": "b36",
      "title": "Emergent abilities of large language models",
      "authors": [
        "Jason Wei",
        "Yi Tay",
        "Rishi Bommasani",
        "Colin Raffel",
        "Barret Zoph",
        "Sebastian Borgeaud",
        "Dani Yogatama",
        "Maarten Bosma",
        "Denny Zhou",
        "Donald Metzler",
        "Ed H Chi",
        "Tatsunori Hashimoto",
        "Oriol Vinyals",
        "Percy Liang",
        "Jeff Dean",
        "William Fedus"
      ],
      "year": "2022",
      "venue": "Transactions on Machine Learning Research",
      "doi": ""
    },
    {
      "id": "b37",
      "title": "Chain of thought prompting elicits reasoning in large language models",
      "authors": [
        "Jason Wei",
        "Xuezhi Wang",
        "Dale Schuurmans",
        "Maarten Bosma",
        "Fei Xia",
        "Ed H Chi",
        "Denny Quoc V Le",
        "Zhou"
      ],
      "year": "2022",
      "venue": "Advances in Neural Information Processing Systems",
      "doi": ""
    },
    {
      "id": "b38",
      "title": "WizardLM: Empowering large pre-trained language models to follow complex instructions",
      "authors": [
        "Can Xu",
        "Qingfeng Sun",
        "Kai Zheng",
        "Xiubo Geng",
        "Pu Zhao",
        "Jiazhan Feng",
        "Chongyang Tao",
        "Qingwei Lin",
        "Daxin Jiang"
      ],
      "year": "2024",
      "venue": "The Twelfth International Conference on Learning Representations",
      "doi": ""
    },
    {
      "id": "b39",
      "title": "Hellaswag: Can a machine really finish your sentence? arXiv preprint",
      "authors": [
        "Rowan Zellers",
        "Ari Holtzman",
        "Yonatan Bisk",
        "Ali Farhadi",
        "Yejin Choi"
      ],
      "year": "2019",
      "venue": "Hellaswag: Can a machine really finish your sentence? arXiv preprint",
      "doi": ""
    },
    {
      "id": "b40",
      "title": "2023a. Marathon: A race through the realm of long context with large language models",
      "authors": [
        "Lei Zhang",
        "Yunshui Li",
        "Ziqiang Liu",
        "Jiaxi Yang",
        "Junhao Liu",
        "Min Yang"
      ],
      "year": "",
      "venue": "2023a. Marathon: A race through the realm of long context with large language models",
      "doi": ""
    },
    {
      "id": "b41",
      "title": "Soaring from 4k to 400k: Extending llm's context with activation beacon",
      "authors": [
        "Peitian Zhang",
        "Zheng Liu",
        "Shitao Xiao",
        "Ninglu Shao",
        "Qiwei Ye",
        "Zhicheng Dou"
      ],
      "year": "2024",
      "venue": "Soaring from 4k to 400k: Extending llm's context with activation beacon",
      "doi": ""
    },
    {
      "id": "b42",
      "title": "Automatic chain of thought prompting in large language models",
      "authors": [
        "Zhuosheng Zhang",
        "Aston Zhang",
        "Mu Li",
        "Alex Smola"
      ],
      "year": "2023",
      "venue": "The Eleventh International Conference on Learning Representations",
      "doi": ""
    },
    {
      "id": "b43",
      "title": "Calibrate before use: Improving few-shot performance of language models",
      "authors": [
        "Zihao Zhao",
        "Eric Wallace",
        "Shi Feng",
        "Dan Klein",
        "Sameer Singh"
      ],
      "year": "2021",
      "venue": "International conference on machine learning",
      "doi": ""
    },
    {
      "id": "b44",
      "title": "LIMA: Less is more for alignment",
      "authors": [
        "Chunting Zhou",
        "Pengfei Liu",
        "Puxin Xu",
        "Srini Iyer",
        "Jiao Sun",
        "Yuning Mao",
        "Xuezhe Ma",
        "Avia Efrat",
        "Ping Yu",
        "Lili Yu",
        "Susan Zhang",
        "Gargi Ghosh",
        "Mike Lewis",
        "Luke Zettlemoyer",
        "Omer Levy"
      ],
      "year": "2023",
      "venue": "Thirty-seventh Conference on Neural Information Processing Systems",
      "doi": ""
    },
    {
      "id": "b45",
      "title": "Instruction-following evaluation for large language models",
      "authors": [
        "Jeffrey Zhou",
        "Tianjian Lu",
        "Swaroop Mishra",
        "Siddhartha Brahma",
        "Sujoy Basu",
        "Yi Luan",
        "Denny Zhou",
        "Le Hou"
      ],
      "year": "2023",
      "venue": "Instruction-following evaluation for large language models",
      "doi": ""
    }
  ],
  "sections": [
    {
      "title": "Uler : A Model-Agnostic Method To Control Generated",
      "text": "Length for Large Language Models Jiaming Li\\({}^{1,2}\\) Lei Zhang\\({}^{1,2}\\) Yunshui Li\\({}^{1,2}\\) Ziqiang Liu\\({}^{1,2}\\) Yuelin Bai\\({}^{1,2}\\) **Run Luo\\({}^{1,2}\\) Longze Chen\\({}^{1,2}\\) Min Yang\\({}^{1}\\)** \\({}^{1}\\)Shenzhen Institute of Advanced Technology, Chinese Academy of Sciences \\({}^{2}\\)University of Chinese Academy of Sciences {jm.li4, min.yang}@siat.ac.cn Min Yang is the corresponding author. Min Yang is the corresponding author."
    },
    {
      "title": "Abstract",
      "text": "The instruction-following ability of large language models enables humans to interact with AI agents in a natural way. However, when required to generate responses of a specific length, large language models often struggle to meet users' needs due to their inherent difficulty in accurately perceiving numerical constraints. To explore the ability of large language models to control the length of generated responses, we propose the Target Length Generation Task (_TLG_) and design two metrics, Precise Match (PM) and Flexible Match (FM) to evaluate the model's performance in adhering to specified response lengths. Furthermore, we introduce a novel, model-agnostic approach called Ruler, which employs Meta Length Tokens (_MLTs_) to enhance the instruction-following ability of large language models under length-constrained instructions. Specifically, Ruler equips LLMs with the ability to generate responses of a specified length based on length constraints within the instructions. Moreover, Ruler can automatically generate appropriate _MLT_ when length constraints are not explicitly provided, demonstrating excellent versatility and generalization. Comprehensive experiments show the effectiveness of Ruler across different LLMs on Target Length Generation Task, e.g., at _All Level_ 27.97 average gain on PM, 29.57 average gain on FM. In addition, we conduct extensive ablation experiments to further substantiate the efficacy and generalization of Ruler. Our code and data is available at [https://github.com/Geaming2002/Ruler](https://github.com/Geaming2002/Ruler)."
    },
    {
      "title": "1 Introduction",
      "text": "Large Language Models (LLMs) have demonstrated remarkable capabilities across a variety of natural language tasks and are increasingly being utilized in various fields (Vaswani et al., 2017; Devlin et al., 2019; Brown et al., 2020). A primary area of interest is the instruction following ability, referring to their capability to execute tasks or generate outputs based on instructions (Ouyang et al., 2022; Wei et al., 2022). It reflects the model's effectiveness in understanding and responding to instructions. The practical challenges highlight the complexity of achieving precise instruction following, particularly when users require control over the output's length. Users frequently give LLMs various instructions, such as \"Tell me how to make a cake in 20 words\", \"Use 50 words to write a post\", \"Write a 300-word story for me\" and so on. These instructions challenge the instruction following capability of LLMs. To explore how well LLMs handle such challenges, we focus on the scenario where users specify the target length of the responses. The question is posed, \"Can LLMs accurately generate with target length?\" and introduce the _Target Length Generation Task (TLG)_. We create a test dataset with various target lengths and introduce two evaluation metrics: Precise Match (PM) and Flexible Match (FM). Our findings reveal that current LLMs generally perform poorly in this task, indicating considerable room for improvement. A discussion on the underlying causes is conducted, primarily attributing it to Figure 1: Existing LLMs lack the capability to follow instructions for generating texts of a specified length. model training strategy. To address aforementioned issues, we introduce Ruler, a model-agnostic approach designed to enhance the instruction-following capability of LLMs through _Meta Length Tokens (MLTs)_. _MLTs_ are designed to control model's responses. By utilizing Ruler, LLMs can generate responses that meet target lengths. We create a dataset with _MLTs_\\(\\mathcal{D}_{MLT}\\) for end-to-end training of LLMs. LLMs learn to generate _MLT_ and the corresponding length response after training. During inference, if a target length is provided, Ruler can transform it into a _MLT_ and generate responses that meet the requirement. If no target length is specified, it first generates a _MLT_, then the response, ensuring its length aligns with the generated _MLT_. We apply Ruler to various large language models and test them on _TLG_. Each model demonstrates significant improvements. Across all evaluated models, we observe a consistent improvement in both PM and FM scores at all _Levels_. The PM and FM scores across _All Level_ showed an average improvement of 27.97 and 29.57.Furthermore, to rigorously test the capabilities of Ruler, we randomly sample the dataset provided by Li et al. (2024) and assess Ruler on multi _MLT_ generation and self-generated _MLT_ experiment to show the its effectiveness and generalizability. Additionally, Ruler is tested on six benchmarks to observe whether the models' overall performance is affected. Our contributions can be summarized as follows: * We introduce the _Target Length Generation Task (TLG)_, which designed to assess the instruction following capability of LLMs. It evaluates how well models generate responses of target lengths as directed by instructions. * We propose Ruler, a novel and model-agnostic approach which employs the _Meta Length Tokens (MLTs)_. Through end-to-end training, it enables models to generate response matching the target lengths indicated by _MLTs_. * We demonstrate that Ruler significantly enhances the performance of various models on the _TLG_. Further experiments have also validated the effectiveness and generalizability of Ruler."
    },
    {
      "title": "2 Related Work",
      "text": ""
    },
    {
      "title": "Large Language Model",
      "text": "The advent of LLMs has revolutionized the field of natural language processing and become a milestone (Vaswani et al., 2017; Devlin et al., 2019; Brown et al., 2020; Zhang et al., 2023). Large language models have achieved success across various NLP tasks. Models such as GPT-4(Achiam et al., 2023), Llama-3(AI@Meta, 2024), and Qwen(Bai et al., 2023), known for their powerful capabilities, are increasingly serving as the foundation for various applications and making significant inroads into diverse fields, exerting a substantial impact. In-context learning enables LLMs to infer and generate responses solely based on the contextual information provided within a prompt(Dong et al., 2022; Wei et al., 2022). This capability allows the models to exhibit a high degree of flexibility and adaptability across a variety of tasks(Levine et al., 2022; Chen et al., 2022; Zhao et al., 2021). CoT further excavates and demonstrates the powerful logical reasoning capabilities of LLMs(Wei et al., 2022; Huang and Chang, 2023; Zhang et al., 2023)."
    },
    {
      "title": "Instruction Following",
      "text": "Instruction following refers to the ability of large language models to comprehend and execute given natural language instructions (Brown et al., 2020; Ouyang et al., 2022; Wei et al., 2022; Zhou et al., 2023). This capability enables the models to perform a broad spectrum of tasks, from simple query responses to complex problem-solving and content generation, tailored to specific user requests. In practical deployments, models may not adhere to comply with user instructions, exhibiting behaviors that deviate from anticipated outcomes. This includes generating responses unrelated to explicit instructions, emitting redundant or erroneous information, or entirely ignoring specified directives (Gehman et al., 2020; Kenton et al., 2021; Wei et al., 2024). To enhance the instruction following capability of LLMs, open-domain instruction following data is frequently used for training. Several prominent studies have explored the construction of instruct-tuning data, to achieve efficient and cost-effective results(Li et al., 2024; Cao et al., 2024; Liu et al., 2024; Xu et al., 2024)."
    },
    {
      "title": "Meta Token",
      "text": "Recently, an increasing number of studies have employed custom tokens within language models to execute specific functions or enhance performance. Todd et al. (2024) report findings that the hidden states of language models capture representations of these functions, which can be condensed into a Function Vector (FV). Furthermore, their research demonstrates that FV can effectively guide language models in performing specific tasks. Numerous studies have utilized meta tokens to compress prompts, thereby enhancing the inference capability of models Li et al. (2023); Liu et al. (2023); Zhang et al. (2024). Mu et al. (2023)introduce the concept of \"gist tokens\", which can be cached and reused for compute efficiency. Further Jiang et al. (2024) utilize a hierarchical and dynamic approach to extend the concept, proposing \"HD-Gist tokens\" to improve model performance."
    },
    {
      "title": "3 Can Llms Accurately Generate With Target Length?",
      "text": "In this section, we examine the capability of LLMs to generate responses of a target length. Initially, we introduce _Target Length Generation Task (TLG)_. Subsequently, we establish various target lengths and two evaluation metrics (SS3.1). We then detail the experimental setup and assess the ability of LLMs to generate responses at target lengths (SS3.2). Finally, we present the outcomes of the experiments and analysis the underlying reasons(SS3.3)."
    },
    {
      "title": "Target Length Generation Task",
      "text": "To assess the ability of existing LLMs to control the length of generated response, we develop the _TLG_. This task assesses the models' ability in producing responses that match target lengths as directed designed target lengths are detailed in Table 1. Additionally, we divide these nine target lengths into three _levels_: _Level:0_, _Level:1_, and _Level:2_. Given that generating responses with target lengths is challenging for existing LLMs, we develop two metrics to evaluate the accuracy of response lengths. * **Precise Match (PM):** This metric requires that the length of the generated response be very close to the target length. For different _Level_, a precise tolerance range is set (\\(\\pm 10\\), \\(\\pm 20\\),...) necessitating that the response length stringently conforms to these defined limits. * **Flexible Match (FM):** This metric requires a broader tolerance interval for target length. For longer texts, the range incrementally widens to meet response generation requirements. For the \\(N\\) responses, we assess whether response meets the target length, then calculating the PM and FM scores of the model. \\[\\mathrm{PM}=\\frac{\\sum_{i=1}^{N}\\mathds{1}\\left(\\mathrm{lb}_{\\mathrm{TL}_{i}}^ {\\mathrm{P}}<L\\left(c_{i}\\right)\\leq\\mathrm{ub}_{\\mathrm{TL}_{i}}^{\\mathrm{P} }\\right)}{N} \\tag{1}\\] \\[\\mathrm{FM}=\\frac{\\sum_{i=1}^{N}\\mathds{1}\\left(\\mathrm{lb}_{\\mathrm{TL}_{i}}^ {\\mathrm{F}}<L\\left(c_{i}\\right)\\leq\\mathrm{ub}_{\\mathrm{TL}_{i}}^{\\mathrm{F} }\\right)}{N} \\tag{2}\\] where: \\(c_{i}\\) denotes the \\(i\\)-th response generated by LLM. The function \\(L(\\cdot)\\) calculates the word count of the input string. \\(\\mathrm{lb}_{\\mathrm{TL}_{i}}^{\\mathrm{P}}\\) and \\(\\mathrm{ub}_{\\mathrm{TL}_{i}}^{\\mathrm{P}}\\) denote the lower and upper bounds of the precise match \\begin{table} \\begin{tabular}{l c c c} \\hline \\hline _Level_ & **Target Length** & **Precise Match (PM)** & **Flexible Match (FM)** \\\\ \\hline \\multirow{4}{*}{_Level:0_} & 10 & \\(\\pm 10\\) & \\((0,20]\\) \\\\ & 30 & \\(\\pm 10\\) & \\((20,40]\\) \\\\ & 50 & \\(\\pm 10\\) & \\((40,60]\\) \\\\ & 80 & \\(\\pm 10\\) & \\((60,100]\\) \\\\ \\hline \\multirow{4}{*}{_Level:1_} & 150 & \\(\\pm 20\\) & \\((100,200]\\) \\\\ & 300 & \\(\\pm 20\\) & \\((200,400]\\) \\\\ & 500 & \\(\\pm 50\\) & \\((400,600]\\) \\\\ \\hline \\multirow{2}{*}{_Level:2_} & 700 & \\(\\pm 70\\) & \\((600,800]\\) \\\\ & \\textgreater{}800 & \\((800,\\infty)\\) & \\((800,\\infty)\\) \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 1: Nine target lengths and their corresponding match ranges categorized as Precise Match (PM) and Flexible Match (FM). Target lengths are classified into three categories, _Level:0_, _Level:1_, and _Level:2_. range associated with the target length of \\(i\\)-th response. \\(\\mathrm{lb}_{\\mathrm{TL}_{i}}^{\\mathrm{F}}\\) and \\(\\mathrm{ub}_{\\mathrm{TL}_{i}}^{\\mathrm{F}}\\) denote the lower and upper bounds of the flexible match range associated with the target length of \\(i\\)-th response."
    },
    {
      "title": "Experimental Setup",
      "text": "Dataset.We employ a two-stage data construction method for this study. Initially, we randomly sample 2,000 data from OpenHermes2.5 (Teknium, 2023). To enhance the complexity of the task and prevent data leakage, the second stage involved uses only the questions from these samples. Additionally, we randomly assign one of nine target lengths for the responses. The distribution of target length in the _TLG_ dataset is shown in Figure 3. Further details regarding the format of the _TLG_ dataset are provided in Appendix A.1. Models & Prompt Templates.We conduct extensive experiments with both closed and open-source LLMs, specifically the chat or instruct version. The specific models used are listed in Table 8. We evaluate each model using its own prompt template, as detailed in Table 9. To integrate the target length into the prompt, we modify the sentence The response should have a word count of {Target Length} words into each question. For target length >800, we replace this with more than 800. Hardware & Hyperparameters.All experiments are conducted on NVIDIA A100 GPUs. Inference is performed using the v1lm(Kwon et al., 2023), with temperature set to 0 and \\begin{table} \\begin{tabular}{l c c c c c c c c} \\hline \\hline \\multirow{2}{*}{**Model**} & \\multirow{2}{*}{**Params**} & \\multicolumn{6}{c}{_Target Length Generation Task (TLG)_} \\\\ \\cline{3-10} & & \\multicolumn{2}{c}{_Level:0_} & \\multicolumn{2}{c}{_Level:1_} & \\multicolumn{2}{c}{_Level:2_} & \\multicolumn{2}{c}{_All Level_} \\\\ \\cline{3-10} & & PM & FM & PM & FM & PM & FM & PM & FM \\\\ \\hline \\hline \\multicolumn{10}{c}{_Closed-source Model1_} \\\\ \\hline gpt-4-turbo & - & **82.26** & **86.36** & **46.49** & **85.06** & 40.72 & 47.51 & 61.35 & 77.35 \\\\ gpt-4o & - & 74.06 & 79.05 & 32.32 & 69.36 & 36.22 & **71.95** & 57.75 & 74.30 \\\\ gpt-3.5-turbo & - & 64.41 & 69.84 & 35.06 & 75.76 & 38.24 & 45.93 & 49.00 & 66.50 \\\\ \\hline claude-3-haiku & - & 48.23 & 55.21 & 35.37 & 73.78 & 44.12 & 50.45 & 43.10 & 60.25 \\\\ claude-3.5-sonnet & - & 75.17 & 81.04 & 42.38 & 83.08 & **62.67** & 71.27 & **61.65** & **79.55** \\\\ \\hline \\hline \\multicolumn{10}{c}{_Open-source Model_} \\\\ \\hline Mistral & 7B & 20.29 & 23.50 & 16.77 & 48.32 & 3.62 & 5.66 & 15.45 & 27.70 \\\\ \\hline \\multirow{2}{*}{Gamma} & 2B & 20.95 & 23.17 & 8.69 & 24.24 & 0.23 & 0.23 & 12.35 & 18.45 \\\\ & 7B & 15.52 & 18.85 & 11.74 & 35.82 & 0.45 & 0.45 & 10.95 & 20.35 \\\\ \\hline \\multirow{2}{*}{Llama3} & 8B & 34.59 & 40.02 & 29.73 & 65.70 & 18.10 & 21.04 & 29.35 & 44.25 \\\\ & 70B & **58.76** & **64.52** & **36.59** & **77.90** & **36.43** & **41.18** & **46.55** & **63.75** \\\\ \\hline \\multirow{2}{*}{InternLM2} & 7B & 6.65 & 7.21 & 8.69 & 27.44 & 19.68 & 22.40 & 10.20 & 17.20 \\\\ & 20B & 8.98 & 9.87 & 10.98 & 34.45 & 17.42 & 20.14 & 11.50 & 20.20 \\\\ \\hline \\multirow{2}{*}{DeepSeek-LLM} & 7B & 28.16 & 31.37 & 17.68 & 44.36 & 10.86 & 13.12 & 20.90 & 31.60 \\\\ & 67B & 26.94 & 30.27 & 17.07 & 49.54 & 9.50 & 11.99 & 19.85 & 32.55 \\\\ \\hline \\multirow{2}{*}{Yi-1.5} & 6B & 23.50 & 25.83 & 16.46 & 48.78 & 18.10 & 20.36 & 20.00 & 32.15 \\\\ & 9B & 25.28 & 29.16 & 17.38 & 44.36 & 24.43 & 29.41 & 22.50 & 34.20 \\\\ & 34B & 28.82 & 33.59 & 26.07 & 65.40 & 21.27 & 25.79 & 26.25 & 42.30 \\\\ \\hline \\multirow{2}{*}{Qwen1.5} & 7B & 24.28 & 27.38 & 14.33 & 46.19 & 9.05 & 11.99 & 17.65 & 30.15 \\\\ & 14B & 28.27 & 31.49 & 18.45 & 43.90 & 11.09 & 14.25 & 21.25 & 31.75 \\\\ \\cline{1-1} & 32B & 32.59 & 36.25 & 22.26 & 49.39 & 21.49 & 25.34 & 26.75 & 38.15 \\\\ \\cline{1-1} & 72B & 35.59 & 39.69 & 18.29 & 49.70 & 3.85 & 6.11 & 22.90 & 35.55 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 2: Overall results of different LLMs of _TLG_. All open-source models used are either chat or instruct models. In models belonging to the same series but varying in parameter sizes, those with larger parameters typically exhibit superior performance. The best-performing model in each _Level_ is **in-bold**, and the second best is underlined. max_tokens set to 2,048 in the SamplingParams, thereby employing greedy decoding for inference. The model_max_length for all models is consistent with their respective configurations, as shown in Table 8."
    },
    {
      "title": "Results And Analysis",
      "text": "Table 2 displays the PM and FM scores of open-source models at different _Levels_. Generally, models with advanced capabilities achieve higher PM and FM scores, indicating stronger adherence to instructions. This observation aligns with human expectations. For most models, scores are lowest at _Level:2_, suggesting significant potential for enhancement in producing longer responses. While, scores at _Level:1_ are the highest. This trend may be attributed to the prevalence of shorter responses in the training datasets utilized for model fine-tuning, which influences their generative biases. Despite potential differences in parameters, a performance gap between closed and open source models remains evident. Notably, Claude-3.5-Sonnet achieve the best scores across all models at the _All Level_, with scores of 61.65 and 79.55. Furthermore, the PM and FM scores for each model across various target lengths are detailed in Appendix A.3. The poor performance in _TLG_ can be attributed to a discrepancy between the token counts generated by LLMs and the lengths as understood by humans. The discrepancy between the tokens generated by LLMs and the lengths as understood by humans constitutes to the issue. This mismatch arises due to several factors: * **Tokenization Schemes:** LLMs employ subword tokenization schemes that decompose words into smaller units of varying lengths. For example, a single long word might be divided into multiple tokens, complicating the model's ability to equate token counts with human-understood word counts [1]. * **Model Training:** Most LLMs, particularly those trained using autoregressive language modeling, are not explicitly trained with objectives that prioritize output length. As a result, these models often lack strong capabilities for controlling the length of their generated output[14]."
    },
    {
      "title": "4 Ruler: Meta Length Token Controlled Generation",
      "text": "In this section, we first introduce Ruler, encompassing the design of the _Meta Length Tokens (MLTs)_, the data collection and the learning process associated with the models (SS4.1). Subsequently, we detail the difference in the generation of Ruler under two scenarios: _TLG_ and non-_TLG_ (SS4.2)."
    },
    {
      "title": "Method",
      "text": "Ruler.We introduce Ruler, as illustrated in Figure 2, to effectively control the response length Figure 3: Target length distribution in _TLG_ dataset. The count of each target length is approximately 200. Figure 2: Overview of Ruler. The method is divided into two parts: training and inference. The figure illustrates the main content of both sections. Additionally, in the inference section, we show two scenarios: _TLG_ and _non-TLG_ to show the difference. of LLMs using _MLTs_. Ruler employs MLTs to explicitly communicate length requirements within instructions. The _MLTs_ represent the model's response length range and aim to enhance its capability on the _TLG_ task. Our end-to-end training enables the LLMs to automatically generate _MLTs_ in various scenarios, regardless of target length requirements. _MLTs_ (Table 3) offer more precise control than traditional text prompt methods, which often prove insufficiently constraining. Data collection for Ruler.For common fine-tuning training datasets, the format typically consist of input-output pairs \\((x,y)\\). Following Zhou et al. (2023), we calculate the word count of \\(y\\) for each entry. Based on the predefined _MLTs_ in Table 3 and their range of variation, we aim to match each \\(y\\) to a corresponding _mlt_ based on its word count. If a match is found, the data is reformatted as \\((x,mlt,y)\\). This method aids in the construction of the fine-tuning training dataset \\(\\mathcal{D}_{MLT}\\), detailed in Algorithm B. Ruler learning.To minimize changes to the model's generation pattern and ensure stability in non-_TLG_ scenario, we position the _MLT_ immediately before the original response during the construction of fine-tuning data. This strategy maintains the model chat template. Consequently, the combination of \\(mlt\\) and the original response \\(y\\) forms a new complete response \\(y^{\\prime}\\). We conduct the training of the Ruler\\(\\mathcal{M}\\) on the curated corpus \\(\\mathcal{D}_{MLT}\\), which is augmented with _Meta Length Tokens \\(\\mathcal{D}_{MLT}\\)_, employing the standard next token objective: \\[\\max_{\\mathcal{M}}\\mathbb{E}_{(x,mlt,y)\\sim\\mathcal{D}_{MLT}}\\log p_{\\mathcal{ M}}(mlt,y|x) \\tag{3}\\] We concatenate the _MLT_ directly to the beginning of \\(y\\) to compute the loss and use the _MLTs_ to expand the original vocabulary \\(\\mathcal{V}\\)."
    },
    {
      "title": "Ruler Inference",
      "text": "Tlg scenario.In the _Target Length Generation (TLG)_ scenario, the user's instruction specifies a target length, decomposed into a question and a target length. The Ruler converts this target length into the corresponding _MLT_ and appends it to the model chat template. Subsequent to the _MLT_, Ruler generates response that aligns with the target length, ensuring compliance with both the user's question and the target length, as illustrated in Figure 2. This approach yields superior results compared to controlling outputs solely through prompts. non-TLG scenario.In the non-TLG scenario, users provide straightforward instructions consisting solely of a question. Ruler integrates these instructions directly into the model's chat template for generation. Owing to its innovative design and the use of a standard next-token objective in training (Equation 3), Ruler autonomously generates a _MLT_ prior to producing the textual response. This _MLT_ is designed to match the length of the content generated, thereby ensuring normal generation of the model in non-TLG scenarios, as illustrated in Figure 2."
    },
    {
      "title": "5 Experiments",
      "text": ""
    },
    {
      "title": "Experimental Setup",
      "text": "Dataset \\(\\mathcal{D}_{MLT}\\).To ensure balanced frequency distribution of each _Meta Length Token (MLT)_ in \\(\\mathcal{D}_{MLT}\\), we set a maximum occurrence limit of 20,000 for each _MLT_. We construct \\(\\mathcal{D}_{MLT}\\) from three datasets: OpenHermes2.5 (excluding data previously used in _TLG_) (Teknium, 2023), LongForm (Koksal et al., 2023), and ELJ5 (Fan et al., 2019), in accordance with Algorithm 1. This approach aims to create a diverse dataset, particularly effective for generating longer content that is relatively rare. in total, \\(\\mathcal{D}_{MLT}\\) comprises 121,229 entries, with the frequency of each _MLT_ in Table 3. Moreover, we calculate the word count for each response in every dataset, allowing us to statistically analyze the _MLT_ distribution, as detailed in Table 16. LLMs.To comprehensively evaluate the performance of Ruler across different models, we consider factors such as model size, open-source availability, and overall model performance. We \\begin{table} \\begin{tabular}{l|c|c} \\hline _MLT_ & **Range of Variation** & **No. in \\(\\mathcal{D}_{MLT}\\)** \\\\ \\hline [MLT:10] & \\([5,15)\\) & 20,000 \\\\ [MLT:30] & \\([25,35)\\) & 20,000 \\\\ [MLT:50] & \\([45,55)\\) & 20,000 \\\\ [MLT:80] & \\([75,85)\\) & 20,000 \\\\ \\hline [MLT:150] & \\([145,155)\\) & 20,000 \\\\ [MLT:300] & \\([295,305)\\) & 10,333 \\\\ [MLT:500] & \\([495,505)\\) & 2,317 \\\\ \\hline [MLT:700] & \\([695,705)\\) & 497 \\\\ [MLT:3\\$800] & \\((800,\\infty)\\) & 8,082 \\\\ \\hline \\end{tabular} \\end{table} Table 3: Meta length tokens in Ruler showing their range of variation in data collection and counts in \\(\\mathcal{D}_{MLT}\\). select six LLMs are selected: Mistral-7B-v0.3 Jiang et al. (2023), gamma-7b Team et al. (2024), Llama-3-8B Al@Meta (2024), deepseek-llm-7b DeepSeek-AI (2024), Yi-1.5-6B AI et al. (2024), and Qwen1.5-7B Bai et al. (2023). We apply the Ruler to these base models and compare the results with their corresponding instruct or chat models. Evaluation Metric.Consistent with the _TLG_ and compared to previous results, we also calculate PM and FM scores to assess the effectiveness of Ruler."
    },
    {
      "title": "Main Results",
      "text": "Table 4 presents a detailed comparison of PM and FM scores across various LLMs using Ruler across different _Levels_. For information on model training see Appendix C.2. Overall Performance Enhancement.Across all evaluated models, we observe a consistent improvement in both PM and FM scores at all _Levels_. The most significant improvement is observed in gamma-7b\\({}_{\\text{R}}\\)1, with PM and FM scores increasing by 34.40 and 37.10, respectively. In contrast, the least improvement is noted with PM and FM rising by 21.35 and 22.15. The PM and FM scores across _All Level_ showed an average improvement of 27.97 and 29.57. These improvements indicate that Ruler effectively enhances the model's ability to generate content of target lengths. This suggests that using _MLT_ to control output length is more effective than using prompts, as the model learns to generate content of corresponding lengths during fine-tuning. Additionally, Ruler's ability to enhance various models demonstrates its generalizability and scalability. Footnote 1: Model name with \\({}_{\\text{R}}\\) means base model with Ruler Different _Level_ Analysis.At _Level:0_, all models show significant improvements in both PM and FM scores. Compared to other _Level_, each model achieves the highest PM and FM score improvements at _Level:0_. This enhancement occurs because the models are capable of generating responses of this length; however, their coarse length control impedes precise adherence to target length requirements. Our method significantly improves the models' capacity to accurately control content length at _Level:0_ more accurately, better meeting the target length requirements. Moving to _Level:1_, while the improvements are not as pronounced as at _Level:0_, the models still exhibit significant gains in both PM and FM scores. At _Level:2_, the extent of score improvements varies across models. For instance, Mistral-7B-v0.3\\({}_{\\text{R}}\\) and gamma-7b\\({}_{\\text{R}}\\) continue to show substantial score increases. Despite these positive trends, only deepseek-llm-7b-chat\\({}_{\\text{R}}\\), show a slight decrease in scores at _Level:2_. This is attributed to the insufficient data for _Level:2_ in \\(\\mathcal{D}_{MLT}\\). The uneven distribution of data likely contributes to the slight decrease in scores. \\begin{table} \\begin{tabular}{l l l l l l l l l} \\hline \\hline \\multirow{2}{*}{**Model**} & \\multicolumn{6}{c}{_Level:0_} & \\multicolumn{3}{c}{_Level:1_} & \\multicolumn{3}{c}{_Level:2_} & \\multicolumn{3}{c}{_All Level_} \\\\ \\cline{2-9} & PM & FM & PM & FM & PM & FM & PM & FM \\\\ \\hline Mistral-7B-Instruct & 20.29 & 23.50 & 16.77 & 48.32 & 3.62 & 5.66 & 15.45 & 27.70 \\\\ Mistral-7B\\({}_{\\text{R}}\\) & 70.18\\(\\sharp\\)49.89 & 75.06\\(\\sharp\\)51.56 & 35.52\\(\\sharp\\)18.75 & 68.44\\(\\sharp\\)19.52 & 33.71\\(\\sharp\\)30.09 & 36.43\\(\\sharp\\)30.75 & 50.75\\(\\sharp\\)13.30 & 64.15\\(\\sharp\\)36.45 \\\\ \\hline gamma-7b-it & 15.52 & 18.85 & 11.74 & 35.82 & 0.45 & 0.45 & 10.95 & 20.35 \\\\ gamma-7b\\({}_{\\text{R}}\\) & 59.53\\(\\sharp\\)44.01 & 64.19\\(\\sharp\\)45.34 & 39.33\\(\\sharp\\)27.59 & 68.14\\(\\sharp\\)33.22 & 25.34\\(\\sharp\\)24.89 & 27.83\\(\\sharp\\)27.38 & 45.35\\(\\sharp\\)34.40 & 57.45\\(\\sharp\\)37.10 \\\\ \\hline Llama-3-8B-Instruct & 34.59 & 40.02 & 29.73 & 65.70 & 18.10 & 21.04 & 29.35 & 44.25 \\\\ Llama-3-8B\\({}_{\\text{R}}\\) & 77.27\\(\\sharp\\)42.68 & 80.71\\(\\sharp\\)40.69 & 50.76\\(\\sharp\\)21.03 & 83.84\\(\\sharp\\)18.14 & 19.23\\(\\sharp\\)1.13 & 22.85\\(\\sharp\\)18.81 & 55.75\\(\\sharp\\)26.40 & 68.95\\(\\sharp\\)24.70 \\\\ \\hline deepseek-llm-7b-chat & 28.16 & 31.37 & 17.68 & 44.36 & 10.86 & 13.12 & 20.90 & 31.60 \\\\ deepseek-llm-7b\\({}_{\\text{R}}\\) & 68.18\\(\\sharp\\)40.02 & 73.50\\(\\sharp\\)42.13 & 31.10\\(\\dagger\\)13.42 & 68.90\\(\\dagger\\)24.54 & 11.54\\(\\dagger\\)0.68 & 11.76\\(\\dagger\\)1.36 & 43.50\\(\\dagger\\)22.60 & 58.35\\(\\dagger\\)26.75 \\\\ \\hline Yi-1.5-6B-Chat & 23.50 & 25.83 & 16.46 & 48.78 & 18.10 & 20.36 & 20.00 & 32.15 \\\\ Yi-1.5-6B\\({}_{\\text{R}}\\) & 67.07\\(\\dagger\\)43.57 & 72.17\\(\\dagger\\)46.34 & 40.40\\(\\dagger\\)23.94 & 76.83\\(\\dagger\\)28.05 & 19.23\\(\\dagger\\)1.13 & 21.04\\(\\dagger\\)0.68 & 47.75\\(\\dagger\\)27.75 & 62.40\\(\\dagger\\)30.25 \\\\ \\hline Qwen1.5-7B-Chat & 24.28 & 27.38 & 14.33 & 46.19 & 9.05 & 11.99 & 17.65 & 30.15 \\\\ Qwen1.5-7B\\({}_{\\text{R}}\\) & 59.09\\(\\dagger\\)34.81 & 64.41\\(\\dagger\\)37.03 & 29.88\\(\\dagger\\)15.55 & 61.28\\(\\dagger\\)15.09 & 11.54\\(\\dagger\\)2.49 & 14.25\\(\\dagger\\)2.26 & 39.00\\(\\dagger\\)21.35 & 52.30\\(\\dagger\\)22.15 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 4: Overall results of various LLMs with Ruler are presented. Additionally, we also annotate the table with the score changes compared to the chat or instruct model. Consistent improvements in both PM and FM scores are observed across all Levels."
    },
    {
      "title": "Do _Mlts_ Actually Influence The Length Of The Generated Content?",
      "text": "To further investigate the effectiveness and scalability of _MLTs_, we designed two additional experiments: multi _MLT_ generation experiment and self-generated _MLT_ experiment. Multi _MLT_ Generation Experiment.To further validate the efficacy and robustness of Ruler, we assess its ability to control response length. We randomly sample 200 entries from Arena-Hard-Auto (Li et al., 2024) and subject each to all target lengths (Table 1), culminating in 1,800 entries at last. Subsequently, we calculate the FM scores for each target length, using the original model as a baseline. The results presented in Table 5 highlight the enhancements in model performance due to Ruler. The FM scores achieved by Ruler generally surpass those of the baseline models. Notably, even the well-performing Llama-3-8B\\({}_{\\text{R}}\\) shows significant improvements. However, when the target length is 700, Ruler shows a decline in FM if the baseline model already achieves a certain score. In contrast, Ruler enhances performance if the baseline model is underperforming. This phenomenon is likely due to an imbalance in the \\(\\mathcal{D}_{MLT}\\), where responses of 700 words are infrequent and differ from the fine-tuning data of the baseline, potentially undermining performance. Overall, Ruler \\begin{table} \\begin{tabular}{l|r r} \\hline \\hline **Model** & **FM** & **Avg WC** \\\\ \\hline \\hline \\multicolumn{1}{l|}{Mistral-7B-v0.3\\({}_{\\text{R}}\\)} & 73.40 & 279 \\\\ \\multicolumn{1}{l|}{gamma-7b\\({}_{\\text{R}}\\)} & 69.00 & 347 \\\\ \\multicolumn{1}{l|}{Llama-3-8B\\({}_{\\text{R}}\\)} & 88.40 & 215 \\\\ \\multicolumn{1}{l|}{deepseek-llm-7b\\({}_{\\text{R}}\\)} & 84.40 & 187 \\\\ \\multicolumn{1}{l|}{Yi-1.5-6B\\({}_{\\text{R}}\\)} & 81.40 & 236 \\\\ \\multicolumn{1}{l|}{Qwen1.5-7B\\({}_{\\text{R}}\\)} & 81.60 & 245 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 6: The FM score and average word count of Ruler with models in self-generated _MLT_ experiment. FM scores are notably high. Specifically, gamma-7b\\({}_{\\text{R}}\\) recorded the lowest at 69.00, while Llama-3-8B\\({}_{\\text{R}}\\) achieved the highest at 88.40. Figure 4: Distribution of _MLTs_ generated by Ruler in self-generated _MLT_ experiment. The models demonstrate a preference for generating responses with lengths of 150 and 300. \\begin{table} \\begin{tabular}{l|r r r r r r r r|r} \\hline \\hline **Model** & \\multicolumn{6}{c|}{FM of Different Target Length} & \\multicolumn{1}{c|}{**Avg FM**} \\\\ \\cline{2-10} & 10 & 30 & 50 & 80 & 150 & 300 & 500 & 700 & \\textgreater{}800 & \\\\ \\hline \\multicolumn{1}{l|}{Mistral-7B-Instruct-v0.3} & 0.5 & 0.0 & 0.5 & 2.0 & 18.5 & 50.5 & 20.5 & 3.0 & 2.5 & 10.89 \\\\ \\multicolumn{1}{l|}{Mistral-7B-v0.3\\({}_{\\text{R}}\\)} & 72.5 & 68.0 & 65.5 & 76.5 & 76.0 & 63.0 & 28.0 & 24.0 & 64.5 & 59.78 \\\\ \\hline \\multicolumn{1}{l|}{gemma-7b-it} & 13.0 & 17.0 & 15.5 & 26.0 & 54.5 & 76.5 & 17.5 & 0.0 & 0.0 & 24.44 \\\\ \\multicolumn{1}{l|}{gemma-7b\\({}_{\\text{R}}\\)} & 58.0 & 63.5 & 61.0 & 69.5 & 72.5 & 64.0 & 42.0 & 17.0 & 67.0 & 57.17 \\\\ \\hline \\multicolumn{1}{l|}{Llama-3-8B-Instruct} & 23.5 & 18.0 & 12.5 & 28.0 & 50.5 & 76.5 & 57.0 & 25.5 & 30.5 & 35.78 \\\\ \\multicolumn{1}{l|}{Llama-3-8B\\({}_{\\text{R}}\\)} & 84.0 & 84.0 & 73.0 & 80.0 & 87.5 & 89.5 & 71.0 & 14.5 & 36.5 & 68.89 \\\\ \\hline \\multicolumn{1}{l|}{deepseek-llm-7b-chat} & 36.5 & 16.0 & 12.5 & 17.5 & 23.5 & 60.5 & 36.5 & 16.0 & 22.5 & 26.83 \\\\ \\multicolumn{1}{l|}{deepseek-llm-7b\\({}_{\\text{R}}\\)} & 64.0 & 70.0 & 62.5 & 73.0 & 82.0 & 86.5 & 27.0 & 17.0 & 40.5 & 58.06 \\\\ \\hline \\multicolumn{1}{l|}{Yi-1.5-6B-Chat} & 26.5 & 16.5 & 14.5 & 14.5 & 18.5 & 42.5 & 35.0 & 33.5 & 28.5 & 25.56 \\\\ \\multicolumn{1}{l|}{Yi-1.5-6B\\({}_{\\text{R}}\\)} & 80.5 & 66.0 & 67.0 & 77.0 & 83.5 & 83.5 & 56.0 & 22.0 & 39.5 & 63.89 \\\\ \\hline \\multicolumn{1}{l|}{Qwen1.5-7B-Chat} & 13.5 & 17.0 & 9.5 & 16.0 & 6.5 & 51.0 & 57.5 & 22.5 & 4.5 & 22.00 \\\\ \\multicolumn{1}{l|}{Qwen1.5-7B\\({}_{\\text{R}}\\)} & 69.0 & 61.0 & 46.5 & 68.5 & 81.0 & 80.5 & 38.5 & 16.5 & 36.5 & 55.33 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 5: Results in multi _MLT_ generation experiment. Generally, the FM scores obtained via Ruler surpass those of the baseline models. significantly improves model performance. Self-generated _MLT_ Experiment.To validate Ruler in generating _MLT_ and responses under a non-_TLG_ scenario, we use the Arena-Hard-Auto dataset without providing _MLTs_, thereby necessitating autonomous response generation by the model. We evaluate performance by cataloging the types and proportions of generated _MLTs_ (Figure 4) and evaluating response length using FM score at the target lengths corresponding to the _MLTs_ (Table 6). Models show a preference for producing responses with target lengths of 150 and 300. This inclination is likely attributable to the complex nature of the queries in the Arena-Hard-Auto, which require longer responses for problem resolution. In the non-_TLG_ scenario, the FM scores are notably high, with the Mistral-7B-v0.3\\({}_{\\mathbf{R}}\\) recording the lowest at 73.40 and Llama-3-8B\\({}_{\\mathbf{R}}\\) achieving the highest at 88.40. The word count across all models varies from 187 words to 347 words."
    },
    {
      "title": "Evaluation On Overall Performance",
      "text": "To evaluate the impact of Ruler on overall performance, we conduct experiments utilizing six benchmark datasets: ARC (Clark et al., 2018), HellaSwag (Zellers et al., 2019), TruthfulQA (Lin et al., 2022), MMLU (Hendrycks et al., 2021), Winogrande (Sakaguchi et al., 2019) and GSM8K (Cobbe et al., 2021). These benchmarks provide a comprehensive assessment across different task types. lm-evaluation-harness Gao et al. (2024) is employed to assess the overall performance. Further details about the experiments on the experiment can be found in Appendix C.4. Table 7 illustrates that Ruler marginally reduces performance on several tasks. Overall performance of models using Ruler generally remains consistent with the original models. The variations in scores are minimal, with changes within a very small range. Moreover, we observe that some models with Ruler actually show improvements in specific tasks. These improvements suggest that Ruler may contribute positively under certain conditions or in certain task types. This indicates that Ruler can significantly enhance the model's ability to follow length-based instructions without compromising its performance on the same data."
    },
    {
      "title": "6 Conclusion",
      "text": "This study initially investigate the instruction following abilities of LLMs and introduces _Target Length Generation Task (TLG)_. Additionally, we propose Ruler, a novel and model-agnostic method that controls generated length for LLMs. Ruler utilizes the _MLT_ and end-to-end training to enhance model performance. Experimental results demonstrate that substantial improvements in PM and FM scores across various models. Moreover, two additional experiments are conducted to further validate the efficacy of the proposed method. Finally, we assess overall performance across six different benchmarks to demonstrate its superiority."
    },
    {
      "title": "Limitations",
      "text": "With the emergence of large language models (LLMs), an increasing number of applications are now utilizing LLMs. A particularly interesting aspect is the instruction-following capabilities of \\begin{table} \\begin{tabular}{l l l l l l l} \\hline \\hline **Model** & **Type** & **ARC (challenge/easy)** & **HellaSwag** & **TruthfulQA** & **MMLU** & **Winogrande** & **GSM8K** \\\\ \\hline Mistral-7B-v0.3 & vanilla & 38.23/67.76 & 48.57 & 46.02 & 34.94 & 62.04 & 26.46 \\\\ - & Ruler & 37.97/67.85 & 47.83 & 47.12 & 37.88 & 62.83 & 27.52 \\\\ \\hline gamma-7b & vanilla & 35.75/65.66 & 45.95 & 41.13 & 32.44 & 57.14 & 23.58 \\\\ - & Ruler & 38.99/67.47 & 45.40 & 45.65 & 31.67 & 60.30 & 25.93 \\\\ \\hline Meta-Llama-3-8B & vanilla & 48.63/77.48 & 58.89 & 51.41 & 50.91 & 71.74 & 44.96 \\\\ - & Ruler & 49.23/77.99 & 59.12 & 51.90 & 50.16 & 71.19 & 46.63 \\\\ \\hline deepsex-llm-7b-base & vanilla & 50.94/79.92 & 61.48 & 39.90 & 48.65 & 72.93 & 38.89 \\\\ - & Ruler & 51.37/79.55 & 61.31 & 38.43 & 48.81 & 72.77 & 37.15 \\\\ \\hline Yi-1.5-6B & vanilla & 51.62/79.25 & 58.79 & 55.32 & 54.68 & 68.51 & 52.01 \\\\ - & Ruler & 51.28/79.46 & 58.41 & 49.94 & 55.13 & 68.11 & 50.34 \\\\ \\hline Qwen1.5-7B & vanilla & 46.67/77.53 & 56.39 & 53.98 & 54.00 & 65.98 & 44.88 \\\\ - & Ruler & 47.27/76.68 & 56.46 & 50.18 & 54.59 & 65.19 & 47.01 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 7: Comparison of the overall performance of six models with Ruler or vanilla, with scores computed on ARC, HellaSwag, TruthfulQA, MMLU, Winogrande and GSM8K. The overall performance of models using Ruler generally remains consistent with the base models with sft. LLMs. In this paper, we analyze the capabilities of LLMs solely from the perspective of controlling generated length and propose a solution through Ruler. Instructions, which vary widely and represent a real-life scenario or application. We believe addressing the challenges or solving widespread issues across various instructions is crucial. We employ meta token to construct Ruler and argue that meta tokens offer more robust control over models than prompts do. Exploring how to develop and utilize models effectively with the help of tokens is a profoundly important question."
    },
    {
      "title": "Ethical Statements",
      "text": "This study concentrates on managing the output length of Large Language Models (LLMs). While our primary focus is on the length of generated content, we have not assessed the potential for producing toxic content. The research does not involve human participants, nor does it handle personal or sensitive information. We have used only open-source or suitably licensed resources, thereby complying with relevant standards. Additionally, all training data employed are open-source, ensuring the exclusion of any private or sensitive information."
    },
    {
      "title": "Acknowledgements",
      "text": "This work was supported by National Key Research and Development Program of China (2022YFF0902100), National Natural Science Foundation of China (Grant No. 62376262), the Natural Science Foundation of Guangdong Province of China (2024A1515030166), Shenzhen Science and Technology Innovation Program (KQTD20190929172835662), Shenzhen Basic Research Foundation (JCYJ20210324115614039)."
    },
    {
      "title": "References",
      "text": "* Achiam et al. (2023) Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Alteschmidt, Sam Altman, Shyamal Anadkat, et al. 2023. Gpt-4 technical report. _arXiv preprint arXiv:2303.08774_. * AI et al. (2024) AI, ;., Alex Young, Bei Chen, Chao Li, Chengen Huang, Ge Zhang, Guanwei Zhang, Heng Li, Jiangcheng Zhu, Jianquen Chen, Jing Chang, Kaidong Yu, Peng Liu, Qiang Liu, Shawn Yue, Senhin Yang, Shiming Yang, Tao Yu, Wen Xie, Wenhao Huang, Xiaohui Hu, Xiaoyi Ren, Xinyao Niu, Pengcheng Nie, Yuchi Xu, Yudong Liu, Yue Wang, Yuxuan Cai, Zhenyu Gu, Zhiyuan Liu, and Zonghong Dai. 2024. Yi: Open foundation models by 01.ai. * AI@Meta (2024) AI@Meta. 2024. Llama 3 model card. * Bai et al. (2023) Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, Binyuan Hui, Luo Ji, Mei Li, Junyang Lin, Runji Lin, Dayiheng Liu, Gao Liu, Chengqiang Lu, Keming Lu, Jianxin Ma, Rui Men, Xingzhang Ren, Xuancheng Ren, Chuanqi Tan, Sinan Tan, Jianhong Tu, Peng Wang, Shijie Wang, Wei Wang, Shengguang Wu, Benfeng Xu, Jin Xu, An Yang, Hao Yang, Jian Yang, Shusheng Yang, Yang Yao, Bowen Yu, Hongyi Yuan, Zheng Yuan, Jianwei Zhang, Xingxuan Zhang, Yichang Zhang, Zhenru Zhang, Chang Zhou, Jingren Zhou, Xiaohuan Zhou, and Tianhang Zhu. 2023. Qwen technical report. _arXiv preprint arXiv:2309.16609_. * Brown et al. (2020) Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. 2020. Language models are few-shot learners. _Advances in neural information processing systems_, 33:1877-1901. * Cao et al. (2024) Yihan Cao, Yanbin Kang, Chi Wang, and Lichao Sun. 2024. Instruction mining: Instruction data selection for tuning large language models. * Chen et al. (2022) Yanda Chen, Ruiqi Zhong, Sheng Zha, George Karypis, and He He. 2022. Meta-learning via language model in-context tuning. In _Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)_, pages 719-730, Dublin, Ireland. Association for Computational Linguistics. * Clark et al. (2018) Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord. 2018. Think you have solved question answering? try arc, the ai2 reasoning challenge. _arXiv preprint arXiv:1803.05457_. * Cobbe et al. (2021) Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, Christopher Hesse, and John Schulman. 2021. Training verifiers to solve math word problems. _arXiv preprint arXiv:2110.14168_. * DeepSeek-AI (2024) DeepSeek-AI. 2024. Deepseek llm: Scaling open-source language models with longtermism. _arXiv preprint arXiv:2401.02954_. * Devlin et al. (2019) Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019. BERT: Pre-training of deep bidirectional transformers for language understanding. In _Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)_, pages 4171-4186, Minneapolis, Minnesota. Association for Computational Linguistics. * Dong et al. (2022) Qingxiu Dong, Lei Li, Damai Dai, Ce Zheng, Zhiyong Wu, Baobao Chang, Xu Sun, Jingjing Xu, and Zhifang Sui. 2022. A survey on in-context learning. _arXiv preprint arXiv:2301.00234_. * Fan et al. (2019) Angela Fan, Yacine Jernite, Ethan Perez, David Grangier, Jason Weston, and Michael Auli. 2019. Eli5: Long form question answering. In _Proceedings of ACL 2019_. * Gage (1994) Philip Gage. 1994. A new algorithm for data compression. _The C Users Journal archive_, 12:23-38. * Gao et al. (2024) Leo Gao, Jonathan Tow, Baber Abbasi, Stella Biderman, Sid Black, Anthony DiPofi, Charles Foster, Laurence Golding, Jeffrey Hsu, Alain Le Noac'h, Haonan Li, Kyle McDonell, Niklas Muennighoff, Chris Ocipea, Jason Phang, Laria Reynolds, Hailey Schoelkopf, Aviya Skowron, Lintang Sutawika, Eric Tang, Anish Thite, Ben Wang, Kevin Wang, and Andy Zou. 2024. A framework for few-shot language model evaluation. * Gehman et al. (2020) Samuel Gehman, Suchin Gururangan, Maarten Sap, Yejin Choi, and Noah A. Smith. 2020. RealToxicityPrompts: Evaluating neural toxic degeneration in language models. In _Findings of the Association for Computational Linguistics: EMNLP 2020_, pages 3356-3369, Online. Association for Computational Linguistics. * Hendrycks et al. (2021) Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt. 2021. Measuring massive multitask language understanding. _Proceedings of the International Conference on Learning Representations (ICLR)_. * Huang and Chang (2023) Jie Huang and Kevin Chen-Chuan Chang. 2023. Towards reasoning in large language models: A survey. In _Findings of the Association for Computational Linguistics: ACL 2023_, pages 1049-1065, Toronto, Canada. Association for Computational Linguistics. * Jiang et al. (2023) Albert Q. Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, Lelio Renard Lavaud, Marie-Anne Lachaux, Pierre Stock, Teven Le Scao, Thibaut Lavril, Thomas Wang, Timothee Lacroix, and William El Sayed. 2023. Mistral 7b. * Jiang et al. (2024) Yichen Jiang, Marco Vecchio, Mohit Bansal, and Anders Johannsen. 2024. Hierarchical and dynamic prompt compression for efficient zero-shot API usage. In _Findings of the Association for Computational Linguistics: EACL 2024_, pages 2162-2174, St. Julian's, Malta. Association for Computational Linguistics. * Kenton et al. (2021) Zachary Kenton, Tom Everitt, Laura Weidinger, Iason Gabriel, Vladimir Mikulik, and Geoffrey Irving. 2021. Alignment of language agents. * Kwon et al. (2023) Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin Zheng, Cody Hao Yu, Joseph E. Gonzalez, Hao Zhang, and Ion Stoica. 2023. Efficient memory management for large language model serving with pagedattention. In _Proceedings of the ACM SIGOPS 29th Symposium on Operating Systems Principles_. * Koksal et al. (2023) Abdullatif Koksal, Timo Schick, Anna Korhonen, and Hinrich Schutze. 2023. Longform: Effective instruction tuning with reverse instructions. * Levine et al. (2022) Yoav Levine, Noam Wies, Daniel Jannai, Dan Navon, Yedid Hoshen, and Amnon Shashua. 2022. The inductive bias of in-context learning: Rethinking pre-training example design. In _International Conference on Learning Representations_. * Li et al. (2024a) Tianle Li, Wei-Lin Chiang, Evan Frick, Lisa Dunlap, Banghua Zhu, Joseph E. Gonzalez, and Ion Stoica. 2024a. From live data to high-quality benchmarks: The arena-hard pipeline. * Li et al. (2023) Yucheng Li, Bo Dong, Frank Guerin, and Chenghua Lin. 2023. Compressing context to enhance inference efficiency of large language models. In _Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing_, pages 6342-6353, Singapore. Association for Computational Linguistics. * Li et al. (2024b) Yunshui Li, Binyuan Hui, Xiaobo Xia, Jiaxi Yang, Min Yang, Lei Zhang, Shuzheng Si, Ling-Hao Chen, Junhao Liu, Tongliang Liu, Fei Huang, and Yongbin Li. 2024b. One-shot learning as instruction data prospector for large language models. * Lin et al. (2022) Stephanie Lin, Jacob Hilton, and Owain Evans. 2022. TruthfulQA: Measuring how models mimic human falsehoods. In _Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)_, pages 3214-3252, Dublin, Ireland. Association for Computational Linguistics. * Liu et al. (2023) Junyi Liu, Liangzhi Li, Tong Xiang, Bowen Wang, and Yiming Qian. 2023. TCRA-LLM: Token compression retrieval augmented large language model for inference cost reduction. In _Findings of the Association for Computational Linguistics: EMNLP 2023_, pages 9796-9810, Singapore. Association for Computational Linguistics. * Liu et al. (2024) Wei Liu, Weihao Zeng, Keqing He, Yong Jiang, and Junxian He. 2024. What makes good data for alignment? a comprehensive study of automatic data selection in instruction tuning. In _The Twelfth International Conference on Learning Representations_. * Mu et al. (2023) Jesse Mu, Xiang Lisa Li, and Noah Goodman. 2023. Learning to compress prompts with gist tokens. In _Thirty-seventh Conference on Neural Information Processing Systems_. * Ouyang et al. (2022) Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al. 2022. Training language models to follow instructions with human feedback. _Advances in neural information processing systems_, 35:27730-27744. Keisuke Sakaguchi, Ronan Le Bras, Chandra Bhagavatula, and Yejin Choi. 2019. Winogrande: An adversarial winograd schema challenge at scale. _arXiv preprint arXiv:1907.10641_. * Team et al. (2020) Gemma Team, Thomas Mesnard, Cassidy Hardin, Robert Dadashi, Surya Bhupatiraju, Shreya Pathak, Laurent Sifre, Morgane Riviere, Mihir Sanjay Kale, Juliette Love, Pouya Tafti, Leonard Hussenot, Pier Giuseppe Sessa, Aakanksha Chowdhery, Adam Roberts, Aditya Barua, Alex Botcey, Alex Castro-Ros, Ambrose Slone, Amelie Heliou, Andrea Tacchetti, Anna Bulanova, Antonia Paterson, Beth Tsai, Bobak Shahriari, Charline Le Lan, Christopher A. Choquette-Choo, Clement Crepy, Daniel Cer, Daphne Ippolito, David Reid, Elena Buchatskaya, Eric Ni, Eric Noland, Geng Yan, George Tucker, George-Christian Muraru, Grigory Rozddestvenskiy, Henryk Michalewski, Ian Tenney, Ivan Grishchenko, Jacob Austin, James Keeling, Jane Labanowski, Jean-Baptiste Lespiau, Jeff Stanway, Jenny Brennan, Jeremy Chen, Johan Ferret, Justin Chiu, Justin Mao-Jones, Katherine Lee, Kathy Yu, Katie Millican, Lars Lowe Sjoesund, Lisa Lee, Lucas Dixon, Machel Reid, Maciej Mikula, Mateo Wirth, Michael Sharman, Nikolai Chinaev, Nithum Thain, Olivier Bachem, Oscar Chang, Oscar Wahltree, Paige Bailey, Paul Michel, Petko Yotov, Rahma Chaabouni, Ramona Commescu, Reena Jana, Rohan Anil, Ross McIlroy, Ruibo Liu, Ryan Mullins, Samuel L Smith, Sebastian Borgeaud, Sertan Girgin, Sholto Douglas, Shree Pandya, Siamak Shakeri, Soham De, Ted Klimenko, Tom Hennigan, Vlad Feinberg, Wojciech Stokowiec, Yu hui Chen, Zafarali Ahmed, Zhitao Gong, Tris Warkentin, Ludovic Peran, Minh Giang, Clement Farabet, Oriol Vinyals, Jeff Dean, Koray Kavukcuoglu, Demis Hassabis, Zoubin Ghahramani, Douglas Eck, Joelle Barral, Fernando Pereira, Eli Collins, Armand Joulin, Noah Fiedel, Evan Senter, Alek Andreev, and Kathleen Kenealy. 2024. Gemma: Open models based on gemini research and technology. * Teknium (2023) Teknium. 2023. Openhermes 2.5: An open dataset of synthetic data for generalist llm assistants. * Todd et al. (2024) Eric Todd, Millicent Li, Arnab Sen Sharma, Aaron Mueller, Byron C Wallace, and David Bau. 2024. Function vectors in large language models. In _The Twelfth International Conference on Learning Representations_. * Vaswani et al. (2017) Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017. Attention is all you need. _Advances in neural information processing systems_, 30. * Wei et al. (2024) Alexander Wei, Nika Haghtalab, and Jacob Steinhardt. 2024. Jailbroken: How does llm safety training fail? _Advances in Neural Information Processing Systems_, 36. * Wei et al. (2022a) Jason Wei, Maarten Bosma, Vincent Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M. Dai, and Quoc V Le. 2022a. Finetuned language models are zero-shot learners. In _International Conference on Learning Representations_. * Wei et al. (2022b) Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, Ed H. Chi, Tatsunori Hashimoto, Oriol Vinyals, Percy Liang, Jeff Dean, and William Fedus. 2022b. Emergent abilities of large language models. _Transactions on Machine Learning Research_. Survey Certification. * Wei et al. (2022c) Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, brian ichter, Fei Xia, Ed H. Chi, Quoc V Le, and Denny Zhou. 2022c. Chain of thought prompting elicits reasoning in large language models. In _Advances in Neural Information Processing Systems_. * Xu et al. (2024) Can Xu, Qingfeng Sun, Kai Zheng, Xiubo Geng, Pu Zhao, Jiazhan Feng, Chongyang Tao, Qingwei Lin, and Daxin Jiang. 2024. WizardLM: Empowering large pre-trained language models to follow complex instructions. In _The Twelfth International Conference on Learning Representations_. * Zellers et al. (2019) Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi. 2019. Hellaswag: Can a machine really finish your sentence? _arXiv preprint arXiv:1905.07830_. * Zhang et al. (2023a) Lei Zhang, Yunshui Li, Ziqiang Liu, Jiaxi yang, Junhao Liu, and Min Yang. 2023a. Marathon: A race through the realm of long context with large language models. * Zhang et al. (2024) Peitian Zhang, Zheng Liu, Shitao Xiao, Ninglu Shao, Qiwei Ye, and Zhicheng Dou. 2024. Soaring from 4k to 400k: Extending llm's context with activation beacon. _arXiv preprint arXiv:2401.03462_. * Zhang et al. (2023b) Zhuosheng Zhang, Aston Zhang, Mu Li, and Alex Smola. 2023b. Automatic chain of thought prompting in large language models. In _The Eleventh International Conference on Learning Representations_. * Zhao et al. (2021) Zihao Zhao, Eric Wallace, Shi Feng, Dan Klein, and Sameer Singh. 2021. Calibrate before use: Improving few-shot performance of language models. In _International conference on machine learning_, pages 12697-12706. PMLR. * Zhou et al. (2023a) Chunting Zhou, Pengfei Liu, Puxin Xu, Srini Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, LILI YU, Susan Zhang, Gargi Ghosh, Mike Lewis, Luke Zettlemoyer, and Omer Levy. 2023a. LIMA: Less is more for alignment. In _Thirty-seventh Conference on Neural Information Processing Systems_. * Zhou et al. (2023b) Jeffrey Zhou, Tianjian Lu, Swaroop Mishra, Siddhartha Brahma, Sujoy Basu, Yi Luan, Denny Zhou, and Le Hou. 2023b. Instruction-following evaluation for large language models. _arXiv preprint arXiv:2311.07911_. Target Length Generation Task Deatils In this section, we present the experimental details of the _Target Length Generation (TLG)_."
    },
    {
      "title": "_Tlg_ Dataset",
      "text": "Dataset constructed for the _TLG_, totaling 2,000 entries."
    },
    {
      "title": "Models & Prompt Templates",
      "text": "In this appendix, we list the models in the _TLG_, including their fullname, params, context length and vocab size. All models are downloaded from Huggingface2 and inference is executed using v1lm(Kwon et al., 2023). Footnote 2: [https://huggingface.co/](https://huggingface.co/) \\begin{table} \\begin{tabular}{l l r r r} \\hline \\hline [MISSING_PAGE_EMPTY:14] [MISSING_PAGE_FAIL:15]"
    },
    {
      "title": "A.3.3 _Level:2_",
      "text": "The PM and FM scores for each model at _Level:2_ are shown in Table 14 and Table 15."
    },
    {
      "title": "Appendix B \\(\\Mathcal{D}_{Mlt}\\) Data Creation",
      "text": ""
    },
    {
      "title": "Appendix C Experiments Details",
      "text": ""
    },
    {
      "title": "_Mlt_ In Datasets",
      "text": "To obtain data with varying response lengths for composing \\(\\mathcal{D}_{MLT}\\), particularly those responses exceeding 500, we integrate data from OpenHermes2.5 (Teknium, 2023), LongForm (Koksal et al., 2023) and ELI5 (Fan et al., 2019). We calculate the word count for each response in every dataset, allowing us to statistically analyze the _MLT_ distribution, shown in Table 16. \\begin{table} \\begin{tabular}{l r r r r r} \\hline \\hline \\multirow{2}{*}{**Model**} & \\multirow{2}{*}{**Params**} & \\multicolumn{4}{c}{_Level:2_} \\\\ \\cline{3-6} & & \\multicolumn{2}{c}{700} & \\multicolumn{2}{c}{\\(>\\)800} \\\\ \\cline{3-6} & & PM & FM & PM & FM \\\\ \\hline gpt-4-turbo & - & **49.57** & 62.61 & 31.13 & 31.13 \\\\ gpt-4o & - & 46.09 & **64.78** & 79.72 & 79.72 \\\\ gpt-3.5-turbo & - & 35.65 & 50.43 & 41.04 & 41.04 \\\\ \\hline claude-3-haiku & - & 39.57 & 51.74 & 49.06 & 49.06 \\\\ claude-3.5-sonnet & - & 36.52 & 53.04 & **91.04** & **91.04** \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 15: Results of closed-source models of _TLG_ at _Level:2_. The best-performing model in each target length is **in-bold**, and the second best is underlined. \\begin{table} \\begin{tabular}{l r r r r r} \\hline \\hline \\multirow{2}{*}{**Model**} & \\multirow{2}{*}{**Params**} & \\multicolumn{4}{c}{_Level:2_} \\\\ \\cline{3-6} & & \\multicolumn{2}{c}{700} & \\multicolumn{2}{c}{\\(>\\)800} \\\\ \\cline{3-6} & & PM & FM & PM & FM \\\\ \\hline Mistral & 7B & 3.04 & 6.96 & 4.25 & 4.25 \\\\ \\hline \\multirow{2}{*}{Gemma} & 2B & 0.00 & 0.00 & 0.47 & 0.47 \\\\ & 7B & 0.87 & 0.87 & 0.00 & 0.00 \\\\ \\hline \\multirow{2}{*}{Llama3} & 8B & 16.09 & 21.74 & 20.28 & 20.28 \\\\ & 70B & 24.35 & **33.48** & **49.53** & **49.53** \\\\ \\hline \\multirow{2}{*}{InternLM2} & 7B & 18.70 & 23.91 & 20.75 & 20.75 \\\\ & 20B & 17.39 & 22.61 & 17.45 & 17.45 \\\\ \\hline \\multirow{2}{*}{DeepSeek-LLM} & 7B & 9.13 & 13.48 & 12.74 & 12.74 \\\\ & 67B & 9.13 & 13.91 & 9.91 & 9.91 \\\\ \\hline \\multirow{2}{*}{Yi-1.5} & 6B & 12.61 & 16.96 & 24.06 & 24.06 \\\\ & 9B & 22.17 & 31.74 & 26.89 & 26.89 \\\\ & 34B & 22.17 & 30.87 & 20.28 & 20.28 \\\\ \\hline \\multirow{2}{*}{Qwen1.5} & 7B & 12.17 & 17.83 & 5.66 & 5.66 \\\\ & 14B & 15.22 & 21.30 & 6.60 & 6.60 \\\\ \\cline{1-1} & 32B & **23.91** & 31.30 & 18.87 & 18.87 \\\\ \\cline{1-1} & 72B & 6.09 & 10.43 & 1.42 & 1.42 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 14: Results of open-source models of _TLG_ at _Level:2_. The best-performing model in each target length is **in-bold**, and the second best is underlined."
    },
    {
      "title": "More Details Of Training",
      "text": "More details of training.We use 4*A100 with 80GB Nvidia GPUs to train the models. The training utilizes both bf16 and tensor tf32 precision formats. The per-device training batch size is set to 4, with gradient accumulation is 8 steps. A cosine learning rate scheduler is applied, starting with an initial learning rate of 2e-5 and a warmup ratio of 0.05. All models are trained for 3 epochs. Additionally, log is set to print every 5 steps. Loss.We document the changes in training loss for all models, as shown in Figure 5. \\begin{table} \\begin{tabular}{l c c c} \\hline \\hline _MLT_ & \\begin{tabular}{c} **OpenHermes2.5** \\\\ (Teknium, 2023) \\\\ \\end{tabular} & \\begin{tabular}{c} **LongForm** \\\\ (Köksal et al., 2023) \\\\ \\end{tabular} & \\begin{tabular}{c} **ELI5** \\\\ (Fan et al., 2019) \\\\ \\end{tabular} \\\\ \\hline \\begin{tabular}{l} [MLT:10] \\\\ [MLT:30] \\\\ [MLT:50] \\\\ [MLT:80] \\\\ \\end{tabular} & 28,552 & 586 & 3,280 \\\\ \\begin{tabular}{l} [MLT:30] \\\\ [18,860 \\\\ 18,867 \\\\ 18,014 \\\\ \\end{tabular} & 1,428 & 14,143 \\\\ \\begin{tabular}{l} [MLT:50] \\\\ [MLT:80] \\\\ \\end{tabular} & 18,867 & 1,236 & 17,597 \\\\ \\begin{tabular}{l} [MLT:80] \\\\ [MLT:150] \\\\ \\end{tabular} & 18,014 & 852 & 15,926 \\\\ \\hline \\begin{tabular}{l} [MLT:150] \\\\ [MLT:300] \\\\ [MLT:500] \\\\ \\end{tabular} & 37,515 & 1,037 & 19,103 \\\\ \\begin{tabular}{l} [MLT:300] \\\\ [MLT:500] \\\\ \\end{tabular} & 7,526 & 252 & 2,555 \\\\ \\begin{tabular}{l} [MLT:500] \\\\ \\end{tabular} & 1,495 & 140 & 682 \\\\ \\hline \\begin{tabular}{l} [MLT:700] \\\\ [MLT:800] \\\\ \\end{tabular} & 193 & 101 & 203 \\\\ \\begin{tabular}{l} [MLT:800] \\\\ \\end{tabular} & 1,809 & 2,465 & 3,808 \\\\ \\hline \\hline \\end{tabular} \\end{table} Table 16: _MLT_ distribution in each dataset. The OpenHermes2.5 excludes the data utilized in _TLG_. The LongForm and ELI5 employs its training, validation, and test sets simultaneously. When multiple answers are available in the dataset, the longest answer is selected as the final response."
    },
    {
      "title": "Multi _Mlt_ Generation Experiment",
      "text": "Here is the results in multi _MLT_ generation experiment."
    },
    {
      "title": "More Details Of Other Tasks",
      "text": "We tested the Ruleron six benchmarks (ARC (Clark et al., 2018), HellaSwag (Zellers et al., 2019), TruthfulQA (Lin et al., 2022), MMLU (Hendrycks et al., 2021), Winogrande (Sakaguchi et al., 2019) and GSM8K (Cobbe et al., 2021)) to examine whether the performance of the fine-tuned models varies on different tasks. We employ 25-shot in ARC, 10-shot setting in Hellaswag, 5-shot setting in MMLU, 0-shot setting in TruthfulQA, 5-shot setting in Winogrande and 5-shot in GSM8K. Figure 5: Training loss for models."
    }
  ]
}